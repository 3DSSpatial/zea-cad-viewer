<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Zea CAD Viewer - Embed</title>

    <link rel="icon" type="image/png" href="favicon-16x16.png" />
    <style>
      body {
        display: flex;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        margin: 0;
      }
      #leftpanel {
        width: 450px;
        display: flex;
        flex-direction: column;
      }
      #rightpanel {
        flex-grow: 1;
      }
      #buttonWrapper {
        display: flex;
      }
      #output {
        flex-grow: 1;
      }
      .btns {
        width: 300px;
        /* display: flex; */
      }
      .btn {
        border-radius: 5px;
        border: 2px solid #f9ce03;
        padding: 5px;
        margin: 5px;
        width: 200px;
        height: 40px;
        text-align: center;
      }
      .btn:hover {
        background-color: #f9ce03;
      }
      #zea-cad-viewer {
        margin-left: auto;
        width: 90%;
        height: 600px;
      }
    </style>
  </head>
  <body>
    <div id="leftpanel">
      <div id="buttonWrapper">
        <div class="btns">
          <button class="btn" id="servo_mestre">servo_mestre</button>
          <button class="btn" id="HC_SRO4">HC_SRO4</button>
          <button class="btn" id="Dead_eye_bearing">Dead_eye_bearing</button>
        </div>
      </div>
      <div id="output"></div>
    </div>
    <div id="rightpanel">
      <iframe id="zea-cad-viewer" src="./viewer/viewer.html"></iframe>
    </div>
    <script type="module">
      const viewer = document.getElementById('zea-cad-viewer')
      console.log(viewer)

      import { ChannelMessenger } from './ChannelMessenger.js'

      const client = new ChannelMessenger(viewer)
      client.on('ready', (data) => {
        client.do('setBackgroundColor', { color: '#E9E7E9' })
      })

      const output = document.getElementById('output')
      client.on('selectionChanged', (data) => {
        output.textContent = JSON.stringify(data)
      })

      const servo_mestreBtn = document.getElementById('servo_mestre')
      servo_mestreBtn.addEventListener('click', () => {
        const json = { url: '../assets/servo_mestre.zcad' }
        if (event.ctrlKey) {
          json.keep = true
        }
        client.do('loadCADFile', json).then((data) => {
          output.textContent = JSON.stringify(data)
        })
      })

      const HC_SRO4Btn = document.getElementById('HC_SRO4')
      HC_SRO4Btn.addEventListener('click', () => {
        const json = { url: '../assets/HC_SRO4.zcad' }
        if (event.ctrlKey) {
          json.keep = true
        }
        client.do('loadCADFile', json).then((data) => {
          output.textContent = JSON.stringify(data)
        })
      })

      const Dead_eye_bearingSTEPBtn = document.getElementById('Dead_eye_bearing')
      Dead_eye_bearingSTEPBtn.addEventListener('click', () => {
        const json = { url: '../assets/Dead_eye_bearingSTEP.zcad' }
        if (event.ctrlKey) {
          json.keep = true
        }
        client.do('loadCADFile', json).then((data) => {
          output.textContent = JSON.stringify(data)
        })
      })
    </script>
  </body>
</html>
